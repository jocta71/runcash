import{U as J,V as K,j as e,W as Q,X as O,Y as ee,Z as se,_ as ae,w as B,L as H,B as F,d as re,e as P,f as D,g as R,h as z,m as I,$ as m,I as M,a0 as te,a1 as w,q as ie,a2 as ne,E as u}from"./ui-TF4rhkS0.js";import{r as i,u as ce,d as oe}from"./vendor-CYNtys_G.js";import{S as L}from"./StrategyService-D2icVBpj.js";var _="Switch",[le,ge]=Q(_),[de,me]=le(_),V=i.forwardRef((t,o)=>{const{__scopeSwitch:a,name:l,checked:h,defaultChecked:v,required:f,disabled:x,value:g="on",onCheckedChange:y,form:k,...S}=t,[j,p]=i.useState(null),T=J(o,d=>p(d)),n=i.useRef(!1),C=j?k||!!j.closest("form"):!0,[b=!1,E]=K({prop:h,defaultProp:v,onChange:y});return e.jsxs(de,{scope:a,checked:b,disabled:x,children:[e.jsx(O.button,{type:"button",role:"switch","aria-checked":b,"aria-required":f,"data-state":X(b),"data-disabled":x?"":void 0,disabled:x,value:g,...S,ref:T,onClick:ee(t.onClick,d=>{E(A=>!A),C&&(n.current=d.isPropagationStopped(),n.current||d.stopPropagation())})}),C&&e.jsx(ue,{control:j,bubbles:!n.current,name:l,value:g,checked:b,required:f,disabled:x,form:k,style:{transform:"translateX(-100%)"}})]})});V.displayName=_;var U="SwitchThumb",W=i.forwardRef((t,o)=>{const{__scopeSwitch:a,...l}=t,h=me(U,a);return e.jsx(O.span,{"data-state":X(h.checked),"data-disabled":h.disabled?"":void 0,...l,ref:o})});W.displayName=U;var ue=t=>{const{control:o,checked:a,bubbles:l=!0,...h}=t,v=i.useRef(null),f=se(a),x=ae(o);return i.useEffect(()=>{const g=v.current,y=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(y,"checked").set;if(f!==a&&S){const j=new Event("click",{bubbles:l});S.call(g,a),g.dispatchEvent(j)}},[f,a,l]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...h,tabIndex:-1,ref:v,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function X(t){return t?"checked":"unchecked"}var $=V,he=W;const q=i.forwardRef(({className:t,...o},a)=>e.jsx($,{className:B("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...o,ref:a,children:e.jsx(he,{className:B("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));q.displayName=$.displayName;const je=()=>{const{id:t}=ce(),o=oe(),a=!!t,[l,h]=i.useState(""),[v,f]=i.useState(""),[x,g]=i.useState(!1),[y,k]=i.useState(!1),[S,j]=i.useState(a),[p,T]=i.useState({detectarRepeticoes:!0,verificarParidade:!1,verificarCores:!1,analisarDezenas:!1,analisarColunas:!1}),[n,C]=i.useState({useDefaultTerminals:!0,customTerminals:[]}),[b,E]=i.useState("");i.useEffect(()=>{a&&t?(async()=>{try{const r=await L.getStrategy(t);r&&(h(r.name),f(r.description||""),g(r.isPublic),T(r.rules),C(r.terminalsConfig))}catch(r){console.error("Erro ao carregar estratégia:",r),u.error("Não foi possível carregar os dados da estratégia")}finally{j(!1)}})():j(!1)},[t,a]);const d=(s,r)=>{T(c=>({...c,[s]:r}))},A=s=>{C(r=>({...r,useDefaultTerminals:s}))},Y=()=>{const s=parseInt(b);if(isNaN(s)||s<0||s>9){u.error("Terminal deve ser um número entre 0 e 9");return}if(n.customTerminals.includes(s)){u.error("Este terminal já foi adicionado");return}C(r=>({...r,customTerminals:[...r.customTerminals,s].sort((c,N)=>c-N)})),E("")},Z=s=>{C(r=>({...r,customTerminals:r.customTerminals.filter(c=>c!==s)}))},G=async s=>{if(s.preventDefault(),!l.trim()){u.error("O nome da estratégia é obrigatório");return}if(!Object.values(p).some(c=>c===!0)){u.error("Selecione pelo menos uma regra para a estratégia");return}if(!n.useDefaultTerminals&&n.customTerminals.length===0){u.error("Adicione pelo menos um terminal personalizado ou use os terminais padrão");return}k(!0);try{const c={name:l,description:v,isPublic:x,rules:p,terminalsConfig:n};let N;a&&t?(N=await L.updateStrategy(t,c),N&&u.success("Estratégia atualizada com sucesso")):(N=await L.createStrategy(c),N&&u.success("Estratégia criada com sucesso")),N?o("/strategies"):u.error("Erro ao salvar estratégia")}catch(c){console.error("Erro ao salvar estratégia:",c),u.error("Erro ao salvar estratégia")}finally{k(!1)}};return S?e.jsx("div",{className:"container mx-auto py-8 flex items-center justify-center h-96",children:e.jsx(H,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"mb-6 flex items-center",children:[e.jsxs(F,{variant:"ghost",onClick:()=>o("/strategies"),className:"mr-4",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Voltar"]}),e.jsx("h1",{className:"text-2xl font-bold",children:a?"Editar Estratégia":"Nova Estratégia"})]}),e.jsx("form",{onSubmit:G,children:e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs(P,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Informações Básicas"}),e.jsx(z,{children:"Defina o nome e descrição da sua estratégia"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Nome da Estratégia *"}),e.jsx(M,{id:"name",value:l,onChange:s=>h(s.target.value),placeholder:"Ex: Estratégia de Colunas",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Descrição"}),e.jsx(te,{id:"description",value:v,onChange:s=>f(s.target.value),placeholder:"Descreva como a estratégia funciona...",rows:4})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"isPublic",checked:x,onCheckedChange:g}),e.jsx(m,{htmlFor:"isPublic",children:"Tornar esta estratégia pública"})]})]})]}),e.jsxs(P,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Regras da Estratégia"}),e.jsx(z,{children:"Selecione quais regras a estratégia irá usar para detectar padrões"})]}),e.jsx(I,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"detectarRepeticoes",checked:p.detectarRepeticoes,onCheckedChange:s=>d("detectarRepeticoes",s===!0)}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"detectarRepeticoes",className:"font-medium",children:"Detectar Repetições"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Detecta quando números se repetem em sequência"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"verificarParidade",checked:p.verificarParidade,onCheckedChange:s=>d("verificarParidade",s===!0)}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"verificarParidade",className:"font-medium",children:"Verificar Paridade"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Analisa sequências de números pares e ímpares"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"verificarCores",checked:p.verificarCores,onCheckedChange:s=>d("verificarCores",s===!0)}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"verificarCores",className:"font-medium",children:"Verificar Cores"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Analisa padrões de cores (vermelho/preto)"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"analisarDezenas",checked:p.analisarDezenas,onCheckedChange:s=>d("analisarDezenas",s===!0)}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"analisarDezenas",className:"font-medium",children:"Analisar Dezenas"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Analisa grupos de dezenas (1-12, 13-24, 25-36)"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"analisarColunas",checked:p.analisarColunas,onCheckedChange:s=>d("analisarColunas",s===!0)}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"analisarColunas",className:"font-medium",children:"Analisar Colunas"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Analisa padrões em colunas da roleta"})]})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(P,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Configuração de Terminais"}),e.jsx(z,{children:"Defina como os terminais serão calculados"})]}),e.jsx(I,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"useDefaultTerminals",checked:n.useDefaultTerminals,onCheckedChange:A}),e.jsx(m,{htmlFor:"useDefaultTerminals",children:"Usar terminais padrão do sistema"})]}),!n.useDefaultTerminals&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{value:b,onChange:s=>E(s.target.value),placeholder:"Terminal (0-9)",maxLength:1,className:"w-24"}),e.jsx(F,{type:"button",variant:"secondary",onClick:Y,children:"Adicionar"})]}),n.customTerminals.length>0&&e.jsxs("div",{children:[e.jsx(m,{className:"mb-2 block",children:"Terminais Selecionados:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.customTerminals.map(s=>e.jsxs("div",{className:"bg-secondary text-secondary-foreground px-3 py-1 rounded-full flex items-center",children:[e.jsx("span",{className:"mr-1",children:s}),e.jsx("button",{type:"button",className:"text-xs text-secondary-foreground/60 hover:text-secondary-foreground",onClick:()=>Z(s),children:"✕"})]},s))})]})]})]})})]}),e.jsxs(P,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Salvar Estratégia"}),e.jsx(z,{children:a?"Atualize a sua estratégia com as novas configurações":"Crie sua estratégia personalizada para roletas"})]}),e.jsx(ie,{children:e.jsx(F,{type:"submit",className:"w-full",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Atualizando...":"Criando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),a?"Atualizar Estratégia":"Criar Estratégia"]})})})]})]})]})})]})};export{je as default};
