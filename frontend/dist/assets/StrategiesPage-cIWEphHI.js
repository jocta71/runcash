import{E as n,j as e,B as a,F as T,L as u,e as j,m as f,f as k,g as F,h as P,q as _,G as O,H as z,J as B,K as q,M as H,N as L,O as R,Q as V,R as M}from"./ui-TF4rhkS0.js";import{d as $,r}from"./vendor-CYNtys_G.js";import{S as p}from"./StrategyService-D2icVBpj.js";import{B as N}from"./badge-ChGZvWD-.js";const A=()=>{const l=$(),[c,d]=r.useState([]),[v,m]=r.useState(!0),[C,t]=r.useState(!1),[i,x]=r.useState(null),[o,h]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{m(!0);try{const s=await p.getStrategies();d(s)}catch(s){console.error("Erro ao carregar estratégias:",s),n.error("Não foi possível carregar as estratégias")}finally{m(!1)}},E=s=>{x(s),t(!0)},b=async()=>{if(i){h(!0);try{await p.deleteStrategy(i._id)?(d(c.filter(y=>y._id!==i._id)),n.success("Estratégia excluída com sucesso")):n.error("Erro ao excluir estratégia")}catch(s){console.error("Erro ao excluir estratégia:",s),n.error("Erro ao excluir estratégia")}finally{h(!1),t(!1),x(null)}}},g=()=>{l("/strategies/create")},w=s=>{l(`/strategies/edit/${s}`)},D=s=>{l(`/strategies/view/${s}`)};return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Minhas Estratégias"}),e.jsxs(a,{onClick:g,children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Nova Estratégia"]})]}),v?e.jsxs("div",{className:"flex justify-center items-center h-64",children:[e.jsx(u,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("span",{className:"ml-2",children:"Carregando estratégias..."})]}):c.length===0?e.jsx(j,{children:e.jsx(f,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Você ainda não criou nenhuma estratégia."}),e.jsx(a,{onClick:g,children:"Criar minha primeira estratégia"})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(s=>e.jsxs(j,{className:"overflow-hidden",children:[e.jsxs(k,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(F,{className:"text-lg",children:s.name}),e.jsxs("div",{className:"flex space-x-1",children:[s.isSystem&&e.jsx(N,{variant:"secondary",className:"bg-blue-500 text-white",children:"Sistema"}),s.isPublic&&e.jsx(N,{variant:"secondary",className:"bg-green-500 text-white",children:"Pública"})]})]}),s.description&&e.jsx(P,{className:"text-sm line-clamp-2",children:s.description})]}),e.jsx(f,{className:"pb-2",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Regras:"})," ",Object.keys(s.rules).length," configuradas"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Terminais:"})," ",s.terminalsConfig.useDefaultTerminals?"Padrão do sistema":s.terminalsConfig.customTerminals.length>0?s.terminalsConfig.customTerminals.join(", "):"Nenhum configurado"]})]})}),e.jsx(_,{className:"pt-2 flex justify-between",children:e.jsxs("div",{className:"space-x-1",children:[e.jsxs(a,{size:"sm",variant:"ghost",onClick:()=>D(s._id),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Ver"]}),!s.isSystem&&e.jsxs(e.Fragment,{children:[e.jsxs(a,{size:"sm",variant:"ghost",onClick:()=>w(s._id),children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Editar"]}),e.jsxs(a,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>E(s),children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Excluir"]})]})]})})]},s._id))}),e.jsx(q,{open:C,onOpenChange:t,children:e.jsxs(H,{children:[e.jsxs(L,{children:[e.jsx(R,{children:"Confirmar exclusão"}),e.jsxs(V,{children:['Tem certeza que deseja excluir a estratégia "',i==null?void 0:i.name,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs(M,{children:[e.jsx(a,{variant:"outline",onClick:()=>t(!1),disabled:o,children:"Cancelar"}),e.jsx(a,{variant:"destructive",onClick:b,disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):e.jsx(e.Fragment,{children:"Excluir"})})]})]})})]})};export{A as default};
